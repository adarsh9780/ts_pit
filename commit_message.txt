fix(agent_v3): resolve planner prompt KeyError for missing query variable

Fixes VDI planner crash:
- KeyError: Input to ChatPromptTemplate is missing variables {'query'}

Root cause:
- planner prompt contained JSON example with unescaped braces, which LangChain
  interpreted as template variables (e.g. {"query": ...}).

Changes:
- backend/agent_v3/prompts/planner.yaml
  - escape JSON example braces with double braces
  - add explicit `User request: {query}` section
- backend/agent_v3/planning.py
  - compute latest user query once
  - pass `query` into prompt_template.invoke(...)
  - reuse computed query when storing last_planned_user_question

Result:
- planner prompt rendering succeeds on VDI and local
- no missing-template-variable failure in planner node
